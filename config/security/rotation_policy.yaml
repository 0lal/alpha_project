# =============================================================================
# ALPHA SOVEREIGN - CREDENTIAL ROTATION & LIFECYCLE POLICY
# =============================================================================
# Path: alpha_project/config/security/rotation_policy.yaml
# Role: Managing the lifespan of secrets to limit the "Blast Radius" of a leak.
# Enforcement: SECURITY DAEMON (Auto-Revoke expired keys)
# =============================================================================

rotation_policy:
  version: "1.5.0-Sovereign"
  
  # [FORENSIC RULE]: ูุงุนุฏุฉ "ุตูุงุญูุฉ ุงูุฒุจุงุฏู".
  # ุงูููุงุชูุญ ุงูุฑูููุฉ ูุซู ุงูุทุนุงูุ ุชูุณุฏ ุจูุฑูุฑ ุงูููุช.
  # ุงุณุชุฎุฏุงู ููุชุงุญ ูุฏูู ูู ุฏุนูุฉ ููุชูุญุฉ ูููุฎุชุฑููู.

# -----------------------------------------------------------------------------
# ๐๏ธ API KEYS LIFECYCLE (ููุงุชูุญ ุงูุนุงูู ุงูุฎุงุฑุฌู)
# -----------------------------------------------------------------------------
external_keys:
  
  # ููุงุชูุญ ุงูููุตุงุช (Binance / Brokers)
  # ูุฐู ุฃุฎุทุฑ ููุงุชูุญ ูุฃููุง ุชููู ุตูุงุญูุฉ ุชุญุฑูู ุงูุฃููุงู.
  exchange_api_keys:
    max_age_days: 90
    forced_rotation: true
    
    # [CRITICAL]: ูุงุฐุง ููุนู ูุจู ุงูุชุฏููุฑุ
    # ูุฌุจ ุงูุชุฃูุฏ ูู ุนุฏู ูุฌูุฏ ุตููุงุช ููุชูุญุฉ ูุนูุฏุฉ ูุฏ ุชุชุถุฑุฑ.
    pre_rotation_check: "WAIT_FOR_FLAT_MARKET"  # ูุง ุชุบูุฑ ุงูููุชุงุญ ูุงูุณูู ูููุงุฑ
    
    # ุชุญุฐูุฑ ุงููุณุชุฎุฏู ูุจู ุงูุชูุงุก ุงูุตูุงุญูุฉ
    alert_user_days_before: 7
  
  # ููุงุชูุญ ุงูุฐูุงุก ุงูุงุตุทูุงุนู (OpenRouter / OpenAI)
  # ุฃูู ุฎุทูุฑุฉ (ูุง ุชููู ูุงูุงู)ุ ููู ุชุณุฑูุจูุง ูููู ุฑุตูุฏุงู.
  ai_provider_keys:
    max_age_days: 180
    forced_rotation: false
    action_on_expiry: "NOTIFY_ONLY"

# -----------------------------------------------------------------------------
# ๐ INTERNAL SECRETS (ุงูุฃุณุฑุงุฑ ุงูุฏุงุฎููุฉ)
# -----------------------------------------------------------------------------
internal_security:
  
  # ุชูููุงุช ุงูุฌูุณุฉ (JWT Secret)
  # ุงูููุชุงุญ ุงูุฐู ูููุน ุฏุฎููู ูููุธุงู. ุฅุฐุง ุณูุฑูุ ูููู ูููุฎุชุฑู ุชุฒููุฑ ูููุชู.
  jwt_signing_secret:
    max_age_hours: 24
    rotation_method: "AUTO_GENERATE"  # ุงููุธุงู ูููุฏ ููุชุงุญุงู ุฌุฏูุฏุงู ูู ููู ุชููุงุฆูุงู
    
    # [GRACE PERIOD]: ูุชุฑุฉ ุงูุชุฏุงุฎู
    # ุงูุณูุงุญ ููููุชุงุญ ุงููุฏูู ุจุงูุนูู ููุฏุฉ 5 ุฏูุงุฆู ูููุน ุทุฑุฏ ุงููุณุชุฎุฏู ูุฌุฃุฉ.
    overlap_window_minutes: 5

  # ููุงุชูุญ ุชุดููุฑ ูุงุนุฏุฉ ุงูุจูุงูุงุช (Data at Rest)
  # ุงูููุชุงุญ ุงูุฐู ูุดูุฑ ูููุงุช ุงูุณุฌูุงุช ูุงููุญูุธุฉ ุงูุจุงุฑุฏุฉ.
  db_encryption_key:
    max_age_days: 365
    rotation_method: "RE_ENCRYPT_ALL_DATA"
    _warning: "High CPU usage operation. Schedule during maintenance window."

  # ููุงุชูุญ ุงูุงุชุตุงู ุจูู ุงูุนูููุงุช (IPC / gRPC Token)
  # ูููุฉ ุงูุณุฑ ุจูู ุจุงูุซูู (Brain) ู Rust (Engine).
  inter_process_token:
    max_age_hours: 12
    rotation_method: "AUTO_ROLLING"

# -----------------------------------------------------------------------------
# ๐๏ธ DISPOSAL PROTOCOL (ุจุฑูุชูููู ุงูุฅุนุฏุงู)
# -----------------------------------------------------------------------------
# ููู ูุชุฎูุต ูู ุงูููุชุงุญ ุงููุฏููุ
key_destruction:
  
  # 1. ุงูุฅุจุทุงู (Revocation)
  # ุฅุฑุณุงู ุทูุจ ููููุตุฉ ูุฅูุบุงุก ุงูููุชุงุญ ููุฑุงู.
  step_1_api_call: "SEND_REVOKE_REQUEST"
  
  # 2. ุงูุชุตููุฑ (Memory Scrubbing)
  # [FORENSIC]: ุงููุชุงุจุฉ ููู ููุงู ุงูููุชุงุญ ูู ุงูุฑุงู ุจุฃุตูุงุฑ ูููุน ุงุณุชุนุงุฏุชู.
  step_2_memory_wipe:
    enabled: true
    passes: 3  # ุงููุชุงุจุฉ ูููู 3 ูุฑุงุช (DoD Standard)
  
  # 3. ุงูุฃุฑุดูุฉ (Audit Log)
  # ุงูุงุญุชูุงุธ ุจู "ุจุตูุฉ" ุงูููุชุงุญ (Hash) ููุท ููุชุงุฑูุฎุ ูููุณ ุงูููุชุงุญ ููุณู.
  step_3_audit_log:
    format: "KeyID: {ID} rotated at {TIME}. Hash: {SHA256}"

# -----------------------------------------------------------------------------
# โ๏ธ EMERGENCY ROTATION (ุชุฏููุฑ ุงูุทูุงุฑุฆ)
# -----------------------------------------------------------------------------
# ูุงุฐุง ูู ุงูุชุดููุง ุงุฎุชุฑุงูุงู ุงูุขูุ
breach_response:
  
  # ุฒุฑ ุงูุชุฏููุฑ ุงูุฃุญูุฑ (Red Button)
  trigger_events:
    - "Unusual IP Login detected"
    - "Withdrawal attempt exceeding limits"
    - "Git Repo accidental public leak"
  
  actions:
    immediate:
      - "REVOKE_ALL_EXCHANGE_KEYS"
      - "INVALIDATE_ALL_SESSIONS"
      - "GENERATE_NEW_INTERNAL_TOKENS"
    
    post_action:
      - "LOCK_SYSTEM_IN_SAFE_MODE"
      - "SEND_URGENT_TELEGRAM_ALERT"

# -----------------------------------------------------------------------------
# ๐ฎ FUTURE PROOFING (ุงูุงุณุชุนุฏุงุฏ ูููุณุชูุจู)
# -----------------------------------------------------------------------------
crypto_agility:
  
  # ุงูุงุณุชุนุฏุงุฏ ูุนุตุฑ ุงููู (Post-Quantum)
  # ุฎูุงุฑุฒููุงุช ุงูุชุดููุฑ ุงูุญุงููุฉ (RSA/ECC) ูุฏ ุชูุณุฑ ูุณุชูุจูุงู.
  algorithm_preference:
    current: "AES-256-GCM"
    future_ready: "Kyber-1024 (Quantum Resistant Placeholder)"
    
  # ุงููุฏุฑุฉ ุนูู ุชุฑููุฉ ุงูุฎูุงุฑุฒููุฉ ุฏูู ุชููู ุงููุธุงู
  auto_upgrade_enabled: true