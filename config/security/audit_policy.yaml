# =============================================================================
# ALPHA SOVEREIGN - ACCESS CONTROL LIST (ACL) & IAM POLICY
# =============================================================================
# Path: alpha_project/config/security/access_control.yaml
# Role: Authentication, Authorization, and Network Perimeter Defense
# Enforcement: KERNEL LEVEL (Any violation triggers immediate ban)
# =============================================================================

access_control:
  version: "5.5.0-Fortress"
  
  # [FORENSIC RULE]: ูุจุฏุฃ "ุงูุนุฏุงู ุงูุซูุฉ" (Zero Trust).
  # ูุง ุชุซู ุจุฃู ุทูุจ ุญุชู ูู ุฌุงุก ูู ุงูุดุจูุฉ ุงูุฏุงุฎููุฉ.
  # ูู ุทูุจ ูุฌุจ ุฃู ูุญูู "ุฌูุงุฒ ุณูุฑ" (Token) ู "ุชุฃุดูุฑุฉ ุฏุฎูู" (Permission).

# -----------------------------------------------------------------------------
# ๐ AUTHENTICATION STANDARDS (ูุนุงููุฑ ุงูุชุญูู ูู ุงููููุฉ)
# -----------------------------------------------------------------------------
authentication:
  
  # ุทุฑููุฉ ุงูุชุดููุฑ ุงููุนุชูุฏุฉ ููุฌูุณุงุช
  token_standard: "JWT (JSON Web Token)"
  algorithm: "Ed25519"  # ุฃููู ูุฃุณุฑุน ูู RSA
  
  # ุนูุฑ ุงูุฌูุณุฉ (Session Lifespan)
  # ุงูุฌูุณุงุช ุงูุทูููุฉ ุฎุทุฑุฉ. ุงุฌุจุฑ ุงููุณุชุฎุฏู ุนูู ุฅุนุงุฏุฉ ุงูุฏุฎูู ุฏูุฑูุงู.
  session_ttl_minutes: 60
  
  # ุณูุงุณุฉ ูููุฉ ุงููุฑูุฑ (ูููุตูู ูููุญุฉ ุงูุชุญูู)
  password_policy:
    min_length: 16
    require_special_chars: true
    rotation_days: 90

  # ุงููุตุงุฏูุฉ ูุชุนุฏุฏุฉ ุงูุนูุงูู (MFA)
  # [CRITICAL]: ุฅุฌุจุงุฑู ููุนูููุงุช ุงูุญุณุงุณุฉ.
  mfa_enforcement:
    login: "OPTIONAL"     # ููุฏุฎูู ุงูุนุงุฏู (ููุณุฑุนุฉ)
    withdrawal: "REQUIRED" # ููุณุญุจ (ููุฃูุงู)
    config_change: "REQUIRED"

# -----------------------------------------------------------------------------
# ๐ฎ ROLE-BASED ACCESS CONTROL (RBAC) - ูุตูููุฉ ุงูุตูุงุญูุงุช
# -----------------------------------------------------------------------------
roles:
  
  # 1. ุงููุงุฆุฏ ุงูุณูุงุฏู (GOD_MODE)
  # ุฃูุช ููุท. ูููู ุตูุงุญูุฉ ูุนู ุฃู ุดูุกุ ุจูุง ูู ุฐูู ุชุฏููุฑ ุงููุธุงู.
  sovereign_commander:
    permissions: ["*"]
    max_concurrent_sessions: 1
    allowed_ips: ["HOME_STATIC_IP", "VPN_SECURE_IP"]

  # 2. ุนููุงุก ุงูุฐูุงุก ุงูุงุตุทูุงุนู (Internal Agents)
  # ุงูุจูุชุงุช ููุง ุตูุงุญูุงุช ูุญุฏูุฏุฉ ุฌุฏุงู.
  ai_agent_trade:
    permissions: ["market:read", "order:place", "order:cancel"]
    denied: ["wallet:withdraw", "config:write"]
    
  ai_agent_analyst:
    permissions: ["market:read", "news:read"]
    denied: ["order:place", "wallet:read"]

  # 3. ูุถุน ุงููุดุงูุฏ (Auditor)
  # ูููุฑุงุฌุนุฉ ููุทุ ูุง ููููู ููุณ ุฃู ุฒุฑ.
  read_only_observer:
    permissions: ["dashboard:view", "logs:read"]
    denied: ["*"]

# -----------------------------------------------------------------------------
# ๐ NETWORK PERIMETER (ุงูุณูุฑ ุงูุฑููู)
# -----------------------------------------------------------------------------
network_security:
  
  # ุงููุงุฆูุฉ ุงูุจูุถุงุก ููุนูุงููู (IP Whitelist)
  # ุงููุธุงู ูุง ูุชุญุฏุซ ุฅูุง ูุน ูุฐู ุงูุนูุงููู. ุงูุจุงูู ูุชู ุชุฌุงููู ุจุตูุช (Stealth Mode).
  ip_whitelist:
    - "127.0.0.1"      # Localhost (Internal Logic)
    - "192.168.1.0/24" # Home Network (Optional)
  
  # ูุดู ุงูุชุณูู (Intrusion Detection)
  rate_limiting:
    max_requests_per_minute: 60
    ban_duration_minutes: 1440  # ุญุธุฑ 24 ุณุงุนุฉ
    
    # [TRAP]: ูุฎ ุงูุนุณู.
    # ุฅุฐุง ุญุงูู ุดุฎุต ุงููุตูู ูุนููุงู /admin/backup.zip (ููู ุบูุฑ ููุฌูุฏ)ุ ุงุญุธุฑู ููุฃุจุฏ.
    honeypot_endpoints:
      - "/admin/backup.zip"
      - "/config/.env"
      - "/api/v1/debug"

# -----------------------------------------------------------------------------
# โข๏ธ DANGEROUS ACTION INTERLOCKS (ุตูุงูุงุช ุงูุฃูุงู ุงูููููุฉ)
# -----------------------------------------------------------------------------
# ุนูููุงุช ุชุชุทูุจ "ุชุฃููุฏุงู ุจุดุฑูุงู" ุฅุถุงููุงู ููุง ูููู ุฃุชูุชุชูุง ุจุงููุงูู.
critical_interlocks:
  
  # ุณุญุจ ุงูุฃููุงู
  withdrawal:
    requires_mfa: true
    requires_email_confirmation: true
    max_amount_per_day: 5000.0
    cooling_off_period_hours: 4
  
  # ุชุนุฏูู ุงูุฏุณุชูุฑ
  constitution_amendment:
    requires_reboot: true
    requires_backup_before_apply: true

  # ุจูุน ุงูููุน (Panic Sell)
  force_liquidate_all:
    confirmation_text_required: "I_ACCEPT_THE_LOSS"
    log_severity: "CRITICAL"

# -----------------------------------------------------------------------------
# ๐ต๏ธ API KEY SECURITY (ุฃูู ุงูููุงุชูุญ)
# -----------------------------------------------------------------------------
api_keys:
  
  # ุงูุชุฏููุฑ ุงูุชููุงุฆู (Rotation)
  # [PREDICTION]: ุงูููุงุชูุญ ุชุชุณุฑุจ ุฏุงุฆูุงู. ุบููุฑูุง ูุจู ุฃู ูุณุชุฎุฏููุง ุงูุนุฏู.
  rotation_policy:
    exchange_keys: "Every 90 days"
    internal_service_keys: "Every 30 days"
  
  # ุชุฎุฒูู ุงูููุงุชูุญ
  # ูุง ุชุฎุฒู ุงูููุงุชูุญ ููุต ูุงุถุญ ุฃุจุฏุงู ูู ุงูุฐุงูุฑุฉ ููุชุฑุฉ ุทูููุฉ.
  storage:
    method: "Environment Variables Only"
    encryption_at_rest: true