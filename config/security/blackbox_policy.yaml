# =============================================================================
# ALPHA SOVEREIGN - BLACK BOX RECORDER POLICY (FDR / CVR)
# =============================================================================
# Path: alpha_project/config/security/blackbox_policy.yaml
# Role: Immutable logging of decisions, state, and errors for post-mortem analysis.
# Enforcement: KERNEL LEVEL (Trading disabled if Black Box is offline)
# =============================================================================

blackbox:
  version: "6.0.0-Forensic"
  
  # [FORENSIC RULE]: ูุงุนุฏุฉ "ุฅุฐุง ูู ููุณุฌูุ ููู ูู ูุญุฏุซ".
  # ูู ุงููุญุงูู ุงููุงููุฉ ูุงูุชูููุฉุ ุงูุฏููู ุงููุญูุฏ ุงูููุจูู ูู ุงูุณุฌู ุงููุดูุฑ ูุงููููุน ุฒูููุงู.

# -----------------------------------------------------------------------------
# ๐๏ธ COCKPIT VOICE RECORDER (CVR) - ุชุณุฌูู ุนูู ุงููุธุงู
# -----------------------------------------------------------------------------
# ุชุณุฌูู ุงูุญูุงุฑ ุงูุฏุงุฎูู ุจูู "ูุฌูุณ ุงูุฅุฏุงุฑุฉ" (ุงูุดุฎุตูุงุช) ูุงูููุฏููุงุช.
decision_recording:
  
  # ุชุณุฌูู "ููุงุฐุง" ุชู ุงุชุฎุงุฐ ุงููุฑุงุฑ
  ai_reasoning_trace:
    enabled: true
    capture_scope:
      - "Full Prompt Sent to LLM"
      - "Raw Response Received"
      - "Parsed Logic (JSON extraction)"
    
    # [PRIVACY]: ุชูููุญ ุงูุจูุงูุงุช ุงูุญุณุงุณุฉ ูุจู ุงููุชุงุจุฉ ุนูู ุงููุฑุต
    # ูููุน ุชุณุฑูุจ ููุงุชูุญ API ูู ุงูุณุฌูุงุช ุจุงูุฎุทุฃ.
    redaction_patterns:
      - "r'sk-[a-zA-Z0-9]{20,}'"  # OpenAI/DeepSeek Keys
      - "r'0x[a-fA-F0-9]{64}'"    # Private Keys

  # ููุทุฉ ูุญุงูุฉ ุงูุณูู ููุช ุงููุฑุงุฑ
  context_snapshot:
    enabled: true
    fields: ["BTC_PRICE", "RSI_VALUE", "FEAR_GREED_INDEX", "ORDER_BOOK_IMBALANCE"]
    _rationale: "To prove the AI acted correctly based on the data it HAD at that moment."

# -----------------------------------------------------------------------------
# โ๏ธ FLIGHT DATA RECORDER (FDR) - ุชุณุฌูู ููุฒูุงุก ุงููุธุงู
# -----------------------------------------------------------------------------
# ุชุณุฌูู ุงูููุงููุณ ุงูุชูููุฉ (ุญุฑุงุฑุฉุ ุณุฑุนุฉุ ุฃุฎุทุงุก).
telemetry_recording:
  
  # ุฏูุฉ ุงูุชุณุฌูู (Sampling Rate)
  sampling:
    normal_mode: "Event Based (On Change)"
    crisis_mode: "High Frequency (Every 100ms)"  # ููุนูู ุชููุงุฆูุงู ุนูุฏ ุงูุชุฐุจุฐุจ ุงูุนุงูู
    
  # ูุง ุงูุฐู ูุณุฌููุ
  metrics:
    - "Latency (API Response Time)"
    - "Memory Usage (RAM)"
    - "Risk Exposure %"
    - "Slippage Detected"

# -----------------------------------------------------------------------------
# ๐ INTEGRITY & IMMUTABILITY (ุงููุฒุงูุฉ ูุนุฏู ุงููุงุจููุฉ ููุชุนุฏูู)
# -----------------------------------------------------------------------------
evidence_protection:
  
  # ุงูุชูููุน ุงูุฑููู (Digital Signing)
  # [FORENSIC]: ูู ููู ุณุฌู ูุชู ุฅุบูุงููุ ูููุฏ ูู ุจุตูุฉ ููุฎุฒููุง.
  hashing:
    algorithm: "SHA-256"
    store_hash_in: "alpha_project/forensics/ledger/checksums.json"
  
  # ุงูุชุซุจูุช ุนูู ุงูุจูููุดูู (Future Proofing)
  # ูุดุฑ ุจุตูุฉ ุงูุณุฌู ุนูู ุดุจูุฉ ุนุงูุฉ ูุฅุซุจุงุช ุงููุฌูุฏ (Proof of Existence).
  blockchain_anchoring:
    enabled: false  # Set to true when wallet is connected
    network: "Polygon (Matic)"
    frequency: "Daily (End of Day Settlement)"

  # ุงูุญูุงูุฉ ูู ุงูุญุฐู (WORM - Write Once, Read Many)
  # ููุน ุงููุธุงู ููุณู ูู ุชุนุฏูู ุงูุณุฌูุงุช ุงููุฏููุฉ.
  file_permissions:
    linux_attr: "+a (Append Only)"

# -----------------------------------------------------------------------------
# ๐ฅ CRASH DUMP PROTOCOL (ุจุฑูุชูููู ุงูุชุญุทู)
# -----------------------------------------------------------------------------
# ูุงุฐุง ูุญุฏุซ ูู ุงููุญุธุงุช ุงูุฃุฎูุฑุฉ ูุจู ุงูููุชุ
fatal_error_handling:
  
  # ุงูุชูุฑูุบ ุงูุทุงุฑุฆ ููุฐุงูุฑุฉ (Core Dump)
  on_system_panic:
    action: "DUMP_MEMORY_STATE_TO_DISK"
    max_dump_size_mb: 512
    include_stack_trace: true
    include_last_100_logs: true
    
  # ุฑุณุงูุฉ ุงููุฏุงุน (Last Gasp)
  # ูุญุงููุฉ ุฃุฎูุฑุฉ ูุฅุฑุณุงู ุงุณุชุบุงุซุฉ ูุจู ุงููุทุงุน ุงูุทุงูุฉ/ุงูุงุชุตุงู.
  last_gasp_alert:
    target: "TELEGRAM_ADMIN"
    message: "SYSTEM CRASHING. DUMP SAVED AT {PATH}. ERROR: {EXCEPTION}"

# -----------------------------------------------------------------------------
# ๐ต๏ธ FORENSIC RETENTION (ุณูุงุณุฉ ุงูุงุญุชูุงุธ ุจุงูุฃุฏูุฉ)
# -----------------------------------------------------------------------------
retention_policy:
  
  # ุงูุณุฌูุงุช ุงููุงููุฉ (Trade Logs) - ูุงููููุงู 5-7 ุณููุงุช
  financial_evidence:
    storage_duration: "7 years"
    storage_type: "Cold Archive (Encrypted Zip)"
  
  # ุณุฌูุงุช ุงูุชุตุญูุญ (Debug Logs) - ุชูููุงู 7 ุฃูุงู
  technical_noise:
    storage_duration: "7 days"
    auto_delete: true

  # ุณุฌูุงุช ุงูุตูุฏูู ุงูุฃุณูุฏ (Incident Reports) - ููุฃุจุฏ
  # ุงูุณุฌูุงุช ุงููุฑุชุจุทุฉ ุจุงูุฎุณุงุฆุฑ ุฃู ุงูุฃุฎุทุงุก ุงููุจุฑู.
  incident_evidence:
    storage_duration: "FOREVER"
    tag: "DO_NOT_DELETE"