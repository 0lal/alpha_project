# =============================================================================
# ALPHA SOVEREIGN - CONTEXT & MEMORY STRATEGY (THE HIPPOCAMPUS)
# =============================================================================
# Path: alpha_project/config/memory/context_strategy.yaml
# Role: Managing the AI's limited attention span (Token Window Management)
# Impact: Prevents Hallucinations & "Lost-in-the-Middle" Phenomenon
# =============================================================================

memory_architecture:
  version: "4.0.0-Sovereign"
  
  # [FORENSIC RULE]: Ù‚Ø§Ø¹Ø¯Ø© "Ø§Ù„Ø§Ù‚ØªØµØ§Ø¯ ÙÙŠ Ø§Ù„ØªÙÙƒÙŠØ±".
  # Ø§Ù„Ø°Ø§ÙƒØ±Ø© Ø£ØºÙ„Ù‰ Ù…ÙˆØ±Ø¯ ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù…. Ù„Ø§ ØªØ¶ÙŠØ¹Ù‡Ø§ ÙÙŠ ØªØ°ÙƒØ± "ØªØ­ÙŠØ© Ø§Ù„ØµØ¨Ø§Ø­".
  # ÙƒÙ„ ØªÙˆÙƒÙ† ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ®Ø¯Ù… Ø§Ù„Ù‡Ø¯Ù Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ: Ø§Ù„Ø±Ø¨Ø­ Ø£Ùˆ Ø§Ù„Ø­Ù…Ø§ÙŠØ©.

# -----------------------------------------------------------------------------
# ğŸ§  MEMORY TIERS (Ø·Ø¨Ù‚Ø§Øª Ø§Ù„Ø°Ø§ÙƒØ±Ø©)
# -----------------------------------------------------------------------------
layers:
  
  # 1. Ø§Ù„Ø°Ø§ÙƒØ±Ø© Ø§Ù„Ø¹Ø§Ù…Ù„Ø© (Working Memory / RAM)
  # Ù…Ø§ ÙŠØ­Ø¯Ø« "Ø§Ù„Ø¢Ù†". (Ø§Ù„Ø³ÙŠØ§Ù‚ Ø§Ù„Ù…Ø¨Ø§Ø´Ø± Ù„Ù„Ù…Ø­Ø§Ø¯Ø«Ø©).
  short_term:
    structure: "Sliding Window"
    capacity_messages: 10
    retention_policy: "FIFO (First In, First Out)"
    focus: "Immediate execution & active alerts"

  # 2. Ø§Ù„Ø°Ø§ÙƒØ±Ø© Ø§Ù„Ø¹Ø±Ø¶ÙŠØ© (Episodic Memory / Summary)
  # Ù…Ø§ Ø­Ø¯Ø« "Ø§Ù„ÙŠÙˆÙ…". (Ù…Ù„Ø®ØµØ§Øª Ø§Ù„Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ù…Ø§Ø¶ÙŠØ©).
  medium_term:
    structure: "Summarized Blocks"
    trigger: "Every 4 hours OR every 50 messages"
    compression_method: "LLM_Summarization"
    _prompt: "Summarize market moves and key decisions. Discard chitchat."

  # 3. Ø§Ù„Ø°Ø§ÙƒØ±Ø© Ø§Ù„Ø¯Ù„Ø§Ù„ÙŠØ© (Semantic Memory / Vector DB)
  # Ø§Ù„Ø®Ø¨Ø±Ø© Ø§Ù„Ù…ØªØ±Ø§ÙƒÙ…Ø© (Ø§Ù„Ø¯Ø±ÙˆØ³ØŒ Ø§Ù„ÙƒØªØ¨ØŒ Ø§Ù„ØªØ§Ø±ÙŠØ®).
  long_term:
    structure: "Vector Embeddings (RAG)"
    retrieval_strategy: "Similarity Search (Cosine Similarity)"
    storage: "ChromaDB / Pinecone (Local)"

# -----------------------------------------------------------------------------
# âš–ï¸ TOKEN BUDGET (Ù…ÙŠØ²Ø§Ù†ÙŠØ© Ø§Ù„Ø§Ù†ØªØ¨Ø§Ù‡)
# -----------------------------------------------------------------------------
# ÙƒÙŠÙ Ù†ÙˆØ²Ø¹ Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ù…ÙˆØ¯ÙŠÙ„ (Ù…Ø«Ù„Ø§Ù‹ 32k ØªÙˆÙƒÙ†) Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø¯Ø®Ù„Ø§ØªØŸ
context_composition:
  
  # Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„Ø¹Ù„ÙŠØ§ (Ø§Ù„Ø¯Ø³ØªÙˆØ± ÙˆØ§Ù„Ø´Ø®ØµÙŠØ©) - [DO NOT TOUCH]
  system_prompt: 
    allocation_percent: 15
    priority: "CRITICAL"
  
  # Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­ÙŠØ© (Ø§Ù„Ø£Ø³Ø¹Ø§Ø±ØŒ Ø§Ù„Ù…Ø¤Ø´Ø±Ø§ØªØŒ Ø§Ù„Ø£Ø®Ø¨Ø§Ø± Ø§Ù„Ø¹Ø§Ø¬Ù„Ø©)
  live_data:
    allocation_percent: 45
    priority: "HIGH"
    strategy: "Most recent ticks + aggregated indicators"
  
  # Ø§Ù„Ø°Ø§ÙƒØ±Ø© Ø§Ù„Ù…Ø³ØªØ±Ø¬Ø¹Ø© (RAG - Ø°ÙƒØ±ÙŠØ§Øª Ø§Ù„Ù…Ø§Ø¶ÙŠ)
  retrieved_context:
    allocation_percent: 25
    priority: "MEDIUM"
    filter: "Only fetch if similarity score > 0.8"
  
  # Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ© (Ø³Ø¤Ø§Ù„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆØ¬ÙˆØ§Ø¨ Ø§Ù„Ø¨ÙˆØª)
  conversation_history:
    allocation_percent: 15
    priority: "LOW"  # ÙŠÙ…ÙƒÙ† Ù‚Øµ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© Ø¥Ø°Ø§ Ø¶Ø§Ù‚ Ø§Ù„Ù…ÙƒØ§Ù†

# -----------------------------------------------------------------------------
# ğŸ—œï¸ COMPRESSION LOGIC (Ù…Ù†Ø·Ù‚ Ø§Ù„Ø¶ØºØ·)
# -----------------------------------------------------------------------------
# [PREDICTION]: Ø§Ù„Ù…ÙˆØ¯ÙŠÙ„Ø§Øª Ø³ØªØµØ¨Ø­ Ø£ØºÙ„Ù‰ Ù…Ø¹ Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø³ÙŠØ§Ù‚. Ø§Ù„Ø¶ØºØ· ÙŠÙˆÙØ± Ø§Ù„Ù…Ø§Ù„ ÙˆØ§Ù„Ø³Ø±Ø¹Ø©.
compression_rules:
  
  # Ø¶ØºØ· Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø±Ù‚Ù…ÙŠØ©
  financial_data:
    action: "Convert raw JSON to Markdown tables"
    _example: "Instead of 50 lines of JSON, use 1 line: | BTC | 95000 | +2% |"
  
  # Ø¶ØºØ· Ø§Ù„Ø£Ø®Ø¨Ø§Ø±
  news_articles:
    action: "Extract Headlines & Sentiment Only"
    remove: ["Boilerplate text", "Author bios", "Ads", "Disclaimers"]

# -----------------------------------------------------------------------------
# ğŸ” RAG STRATEGY (Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ø°Ø§ÙƒØ±Ø©)
# -----------------------------------------------------------------------------
retrieval_augmented_generation:
  enabled: true
  
  # Ù…ØªÙ‰ Ù†Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù…Ø§Ø¶ÙŠØŸ
  triggers:
    - "User asks about historical events ('What happened in 2021?')"
    - "System detects a pattern similar to a previous crash"
    - "Complex strategy formulation request"

  # Ù…Ø§Ø°Ø§ Ù†Ø³ØªØ±Ø¬Ø¹ØŸ
  query_expansion:
    enabled: true
    _logic: "If user asks 'inflation', also search for 'CPI', 'Rates', 'Fed'."

# -----------------------------------------------------------------------------
# ğŸ›¡ï¸ AMNESIA PREVENTION (Ù…Ù†Ø¹ Ø§Ù„Ù†Ø³ÙŠØ§Ù†)
# -----------------------------------------------------------------------------
# Ø­Ù…Ø§ÙŠØ© Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„Ø­Ø³Ø§Ø³Ø© Ù…Ù† Ø£Ù† ØªÙØ·Ø±Ø¯ Ø®Ø§Ø±Ø¬ Ø§Ù„Ù†Ø§ÙØ°Ø©.
critical_anchors:
  always_include:
    - "User Risk Profile (Risk Tolerance)"
    - "Current Portfolio Balance"
    - "Stop-Loss Rules"
    - "Guardian Sentinel Veto Status"