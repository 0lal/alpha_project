syntax = "proto3";

package alpha.transport.events;

option java_multiple_files = true;
option java_package = "com.alpha.transport.events";
option go_package = "alpha/transport/events;events";

// Goal: بث أحداث الاستراتيجية مثل الإشارات والإنذارات.
// Dependencies: Strategy Engine, Risk Dashboard

// أحداث الاستراتيجية (AlphaDetected, StopLossHit)
enum StrategyEventType {
  STRATEGY_EVENT_TYPE_UNSPECIFIED = 0;
  STRATEGY_EVENT_TYPE_ALPHA_DETECTED = 1;
  STRATEGY_EVENT_TYPE_STOP_LOSS_HIT = 2;
  STRATEGY_EVENT_TYPE_TAKE_PROFIT_HIT = 3;
  STRATEGY_EVENT_TYPE_STRATEGY_DISABLED = 4;
}

message AlphaDetected {
  string symbol = 1;
  double score = 2;
  double confidence = 3;
  string horizon = 4;
}

message StopLossHit {
  string symbol = 1;
  double entry_price = 2;
  double stop_price = 3;
  double realized_pnl = 4;
}

message StrategyEvent {
  string event_id = 1;
  string trace_id = 2;
  string strategy_id = 3;
  StrategyEventType type = 4;
  int64 timestamp_ms = 5;
  oneof payload {
    AlphaDetected alpha_detected = 6;
    StopLossHit stop_loss_hit = 7;
  }
}
